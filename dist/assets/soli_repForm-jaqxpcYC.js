import{y as ut,H as b,a4 as mt,D as _t,a2 as S,E as pt,o as d,c as f,b as s,w as r,a as t,d as m,t as c,z as _,k as y,s as I,F as k,x as j,ab as L,ac as U,a3 as ft,r as bt,P as ht,Q as Dt}from"./index-UQ4Y6tg0.js";import{a as vt,u as xt}from"./soli_rep-BRJAUUCG.js";import{v as M}from"./validateText-UQqnbmko.js";import{B as gt}from"./BaseBreadcrumb-W1wES-3W.js";import{V as g,a as E}from"./VRow-WBpPnLNW.js";import{V as yt}from"./VAlert-Jl0eCssJ.js";import{V as Vt}from"./VDialog-BIR7vFWz.js";import{V as Ct,a as wt,b as It,c as kt}from"./VCard-BhV8WZVD.js";import{V as Et}from"./VContainer-CV7dclpz.js";import{V as R}from"./VTextField-DeAqw0yG.js";import{V as Rt}from"./VAutocomplete-BTZ8WdyE.js";import{V as Bt}from"./VSpacer-CEFY0jj2.js";import{V as D}from"./VBtn-ndw5bw-d.js";import{V as St,a as G,b as H,c as q}from"./VExpansionPanel-C5JNfAo0.js";import{V as J}from"./VTable-dhueEJX-.js";import{V as Nt}from"./VProgressCircular-Cbcc6kKX.js";import{_ as Tt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useRender-BDbWIC24.js";import"./router-B8MK5mse.js";import"./VAvatar-DagqDaY3.js";import"./transition-DbEkOsnp.js";import"./VOverlay-8Bsthg4h.js";import"./forwardRefs-D3j0TLhE.js";import"./lazy-BR5DRUVx.js";import"./scopeId-DZLMB9Wp.js";import"./dialog-transition-8282kSpg.js";import"./VField-BPphxynK.js";import"./index-aGYOX0Ta.js";import"./VLabel-BjwzkBDE.js";import"./VInput-X2aYp1ap.js";import"./VSelect-DnNs7nru.js";import"./VList-f2BTb-_H.js";import"./ssrBoot-oE9JGkZo.js";import"./VDivider-C0Ppt4EB.js";import"./VMenu-BGaQHAKr.js";import"./resizeObserver-Cvf-jka2.js";import"./VCheckboxBtn-BpR-ko92.js";import"./VSelectionControl-VoFG-Zor.js";import"./VChip-Cs9FIXGL.js";import"./VSlideGroup-BpPVSxjp.js";import"./group-DutvcN0X.js";import"./filter-DkWuySZr.js";const l=B=>(ht("data-v-23c6c189"),B=B(),Dt(),B),Ot={style:{display:"flex","justify-content":"space-between"}},Ut=l(()=>t("b",null,"PLACA :",-1)),Ft={class:"text-primary"},Pt=l(()=>t("b",null,"CHASIS :",-1)),At={class:"text-primary"},$t=l(()=>t("b",null,"TIPO :",-1)),zt={class:"text-primary"},jt={style:{display:"flex","justify-content":"space-between"}},Lt=l(()=>t("b",null,"MARCA :",-1)),Mt={class:"text-primary"},Gt=l(()=>t("b",null,"COLOR :",-1)),Ht={class:"text-primary"},qt=l(()=>t("b",null,"FECHA DE INGRESO :",-1)),Jt={class:"text-primary"},Qt={style:{display:"flex","justify-content":"space-between"}},Kt=l(()=>t("b",null,"CONDUCTOR :",-1)),Wt={class:"text-primary"},Xt=l(()=>t("b",null,"CEL :",-1)),Yt={class:"text-primary"},Zt=l(()=>t("b",null,"PRE - DIAGNOSTICO :",-1)),te={class:"text-primary"},ee=l(()=>t("span",{class:"text-h5"},"Información del Repuesto",-1)),oe=l(()=>t("th",{class:"text-center"},"N° ",-1)),ae=l(()=>t("th",{class:"text-center"},[t("b",null," Repuesto")],-1)),se=l(()=>t("th",{class:"text-center"},[t("b",null," Cantidad")],-1)),re=l(()=>t("th",{class:"text-center"},[t("b",null," Unidad")],-1)),ne=l(()=>t("th",{class:"text-center"},[t("b",null," Costo")],-1)),le=l(()=>t("th",{class:"text-center"},[t("b",null," Observación")],-1)),ie=l(()=>t("th",{class:"text-center"},[t("b",null," Entregado")],-1)),de=l(()=>t("th",{class:"text-center"},[t("b",null," Recibido")],-1)),ce={key:0,class:"text-center"},ue=l(()=>t("b",null,"Acción",-1)),me=[ue],_e={class:"text-center"},pe={class:"text-center"},fe={class:"text-center"},be={class:"text-center"},he={class:"text-center"},De={class:"text-center"},ve={key:0,class:"text-center"},xe={key:1,class:"text-center"},ge={key:2,class:"text-center"},ye={key:3,class:"text-center"},Ve={key:4,class:"text-center"},Ce={key:5,class:"text-center"},we={key:6,class:"text-center"},Ie=l(()=>t("thead",null,[t("tr",null,[t("th",{class:"text-center"},"N° "),t("th",{class:"text-center"},[t("b",null," Repuesto")]),t("th",{class:"text-center"},[t("b",null," Cantidad")]),t("th",{class:"text-center"},[t("b",null," Unidad")]),t("th",{class:"text-center"},[t("b",null," Costo")]),t("th",{class:"text-center"},[t("b",null," Observación")])])],-1)),ke={class:"text-center"},Ee={class:"text-center"},Re={class:"text-center"},Be={class:"text-center"},Se={class:"text-center"},Ne={class:"text-center"},Te=l(()=>t("td",null,null,-1)),Oe=l(()=>t("td",null,null,-1)),Ue=l(()=>t("td",null,null,-1)),Fe=l(()=>t("td",null,null,-1)),Pe=l(()=>t("td",{class:"text-center"},[t("b",null,"Total: ")],-1)),Ae={class:"text-center"},$e=ut({__name:"soli_repForm",setup(B){const V=b(!1),x=JSON.parse(localStorage.getItem("user")||"").id_perfil;JSON.parse(localStorage.getItem("user")||"").id_taller;const F=b([0]),C=mt(),w=vt(),v=xt(),Q=b(!1),N=b(!0),T=b(!1),K=b({title:"Solicitud de Repuestos"}),W=b([{text:"Dashboard",disabled:!1,href:"/home"},{text:"Repuestos",disabled:!0,href:"#"}]),P=b(!0),X=b(!1);JSON.parse(localStorage.getItem("user")||"").nombre_perfil;const e=_t({formData:{id_orden:"",id_registro:"",placa_chasis:"",nombre_taller:"",placa:"",chasis:"",marca:"",modelo:"",motor:"",color_ve:"",placas:"",chasis_:"",kilometraje:"",nro_ocupantes:"",observaciones:"",requerimientos:"",tipo_orden:"",nombre_conductor:"",celular_con:"",tipo_man:"",prediagnostico:"",id_mecanico:"",id_vehiculo:"",nombre_completo:"",nombre_accesorio:"",observacion_ac:"",id_accesorio:"",accesorios_orden:[],dato1:"",dato2:"",dato3:"",dato4:"",nombre_dignostico:"",id_trabajo:"",id_tipo_trabajo:"",nombre_trabajo:"",id_diagnostico:"",nombre_diagnostico:"",prueba:"",repuestos:[],id_sis:"",id_filtro:"",cantidad_r:"",unidad_r:"",observacion_r:"",id_Rep:[],id_Rep2:[],id_accesorios_:[],cedula_identidad:"",total_c:"",total:""},formData2:{fuerza:"",nombre_repuesto:"",id_registro:"",id_repuesto:"",id_solicitud:"",cantidad:"",unidad:"",costo:"",observacion:"",precio:"",id_det:"",estado:"",disponible:""}}),A=b([]),Y=b([]),Z=b([]),tt=async()=>{Y.value=await w.gettipo_trabajo(),Z.value=await w.gettipo_mantenimiento(),A.value=await w.getUnidad()},et=async u=>{const o=await w.getbasico(u);e.formData.id_orden=o.id,e.formData.dato1=o.placa,e.formData.dato2=o.chasis,e.formData.nombre_completo=o.nombre_conductor,e.formData.dato3=o.fecha,e.formData.dato4=o.prediagnostigo,e.formData.marca=o.marca,e.formData.kilometraje=o.kilometraje,e.formData.tipo_orden=o.tipo,e.formData.color_ve=o.color,e.formData.prueba=o.prueba,e.formData2.fuerza=o.fuerza},ot=async u=>{const o=await w.verificar_reg(u);Object.keys(o).length>0&&(e.formData.id_registro=o.id_registro)},at=async u=>{e.formData.id_Rep=await v.getsolicitudes(u),console.log(e.formData.id_Rep),e.formData.id_Rep2=await v.getEntregas(u);const o=await v.getEntregas(u);let n=0;for(let i=0;i<o.length;i++)n=n+parseInt(o[i].costo);e.formData.total_c=String(n);const a=await v.getTotal(u);e.formData.total=a.total},h=b([]),$=async u=>{const o=await v.getID(u);if(e.formData2.id_registro=o.id,e.formData2.id_repuesto=o.id_tipo_repuesto,e.formData2.id_solicitud=o.id_solicitud,e.formData2.nombre_repuesto=o.nombre_repuesto,e.formData2.cantidad=o.cantidad,e.formData2.unidad=o.unidad,e.formData2.precio=o.precio,e.formData2.id_det=o.id_det,e.formData2.estado=o.entregado,e.formData2.disponible=o.can_rep,parseInt(o.costo)>0)e.formData2.costo=o.costo;else if(parseInt(e.formData2.disponible)>0||parseInt(o.costo)==0){h.values=await v.getPrecio(e.formData2.id_repuesto);let n=parseInt(e.formData2.cantidad),a=0,i=0;if(h.values.length>0)for(let p=0;p<h.values.length;p++)h.values[p].entregado>0?(i=parseInt(h.values[p].cantidad)-parseInt(h.values[p].entregado),i==n?n>0&&(a=a+n*parseInt(h.values[p].precio_u),n=Math.max(n-i,0)):i>parseInt(e.formData2.cantidad)?n>0&&(a=a+parseInt(e.formData2.cantidad)*parseInt(h.values[p].precio_u),n=Math.max(n-n,0)):n>0&&(a=a+i*parseInt(h.values[p].precio_u),n=Math.max(n-i,0)),e.formData2.costo=String(a)):(parseInt(e.formData2.cantidad)==n&&n>0&&(a=a+n*parseInt(h.values[p].precio_u),n=Math.max(n-i,0)),parseInt(e.formData2.cantidad)>n?(a=a+parseInt(e.formData2.cantidad)*parseInt(h.values[p].precio_u),n=Math.max(n-n,0)):(a=a+i*parseInt(h.values[p].precio_u),n=Math.max(n-i,0)),e.formData2.costo=String(a));else e.formData2.costo=""}else e.formData2.costo="";V.value=!0},st=()=>{const u=parseFloat(e.formData2.cantidad)||0,o=parseFloat(e.formData2.precio)||0;e.formData2.costo=(u*o).toFixed(2)},rt=()=>{ft.push({name:"ordenList"})},nt=async u=>{await v.minutesReport(u)},z=async()=>{Q.value=!0,await lt(),N.value&&(T.value=!0,e.formData.id_orden!="0"&&(V.value=!1,S.fire({title:"¿Estás seguro?",text:"Verifica que la información registrada sea correcta",icon:"warning",showCancelButton:!0,cancelButtonColor:"#FA896B",confirmButtonColor:"#5D87FF",cancelButtonText:"No, volver",confirmButtonText:"Si, actualizar"}).then(async u=>{if(u.isConfirmed){const{ok:o,message:n}=await v.updateRepID(e.formData2),a=o?"success":"error";O.fire({icon:a,title:n})}window.location.reload()})),T.value=!1)},lt=async()=>{N.value=!0,(!e.formData2.cantidad||!e.formData2.unidad)&&(N.value=!1)},it=()=>{V.value=!1},O=S.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0});function dt(u){S.fire({text:"¡El proceso no podra ser revertido!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Si, entregar!"}).then(async o=>{if(o.isConfirmed){const{ok:n,message:a}=await v.updateEstado1({id:u}),i=n?"success":"error";O.fire({icon:i,title:a}),window.location.reload()}})}function ct(u){S.fire({text:"¿Recibió el repuesto?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Si!"}).then(async o=>{if(o.isConfirmed){const{ok:n,message:a}=await v.updateEstado2({id:u}),i=n?"success":"error";O.fire({icon:i,title:a})}window.location.reload()})}return pt(async()=>{await tt(),C.params.id_orden!="0"&&(await ot(C.params.id_orden),parseInt(e.formData.id_registro)>0?await at(C.params.id_orden):console.log("0"),await et(C.params.id_orden),X.value=!0)}),(u,o)=>{const n=bt("v-rom");return d(),f(k,null,[s(gt,{title:K.value.title,breadcrumbs:W.value},null,8,["title","breadcrumbs"]),s(E,null,{default:r(()=>[s(g,{cols:"12",lg:"12"},{default:r(()=>[s(yt,{variant:"outlined",type:"warning",border:"top",icon:"$warning",title:"INFORMACIÓN DEL VEHÍCULO",closable:""},{default:r(()=>[t("div",Ot,[t("div",null,[Ut,m(),t("span",Ft,c(e.formData.dato1),1)]),t("div",null,[Pt,m(),t("span",At,c(e.formData.dato2),1)]),t("div",null,[$t,m(),t("span",zt,c(e.formData.tipo_orden),1)])]),t("div",jt,[t("div",null,[Lt,m(),t("span",Mt,c(e.formData.marca),1)]),t("div",null,[Gt,m(),t("span",Ht,c(e.formData.color_ve),1)]),t("div",null,[qt,m(),t("span",Jt,c(e.formData.dato3),1)])]),t("div",Qt,[t("div",null,[Kt,m(),t("span",Wt,c(e.formData.nombre_completo),1)]),t("div",null,[Xt,m(),t("span",Yt,c(e.formData.dato3),1)]),t("div",null,[Zt,m(),t("span",te,c(e.formData.dato4),1)])])]),_:1})]),_:1})]),_:1}),s(n,null,{default:r(()=>[s(Vt,{modelValue:V.value,"onUpdate:modelValue":o[12]||(o[12]=a=>V.value=a),"max-width":"1000px"},{default:r(()=>[s(Ct,null,{default:r(()=>[s(wt,{class:"pa-2 bg-success"},{default:r(()=>[ee]),_:1}),s(It,null,{default:r(()=>[s(Et,null,{default:r(()=>[s(E,null,{default:r(()=>[s(g,{cols:"12",md:"4"},{default:r(()=>[s(R,{modelValue:e.formData2.nombre_repuesto,"onUpdate:modelValue":o[0]||(o[0]=a=>e.formData2.nombre_repuesto=a),label:"Repuesto",readonly:""},null,8,["modelValue"])]),_:1}),s(g,{cols:"12",md:"3"},{default:r(()=>[s(R,{onInput:o[1]||(o[1]=a=>(st(),e.formData2.cantidad)),modelValue:e.formData2.cantidad,"onUpdate:modelValue":o[2]||(o[2]=a=>e.formData2.cantidad=a),label:"Cantidad",type:"number",min:1},null,8,["modelValue"])]),_:1}),s(g,{cols:"12",md:"3"},{default:r(()=>[s(Rt,{variant:"outlined",label:"Unidad",color:"primary","hide-details":"",items:A.value,modelValue:e.formData2.unidad,"onUpdate:modelValue":o[3]||(o[3]=a=>e.formData2.unidad=a),"no-data-text":"No existe más opciones para seleccionar","item-value":"nombre_unidad","item-title":"nombre_unidad",onInput:o[4]||(o[4]=a=>e.formData2.unidad=_(M)(e.formData2.unidad.toUpperCase()))},null,8,["items","modelValue"])]),_:1}),s(g,{cols:"12",md:"2"},{default:r(()=>[_(x)==1||_(x)==2?(d(),y(R,{key:0,modelValue:e.formData2.costo,"onUpdate:modelValue":o[5]||(o[5]=a=>e.formData2.costo=a),"min:0":"",label:"Precio Unitario",type:"number"},null,8,["modelValue"])):(d(),y(R,{key:1,modelValue:e.formData2.costo,"onUpdate:modelValue":o[6]||(o[6]=a=>e.formData2.costo=a),"min:0":"",label:"Costo",type:"number",readonly:""},null,8,["modelValue"]))]),_:1}),s(g,{cols:"12",md:"12"},{default:r(()=>[s(R,{modelValue:e.formData2.observacion,"onUpdate:modelValue":o[7]||(o[7]=a=>e.formData2.observacion=a),label:"Observación",type:"text",onInput:o[8]||(o[8]=a=>e.formData2.observacion=_(M)(e.formData2.observacion.toUpperCase()))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),s(kt,null,{default:r(()=>[s(Bt),s(D,{color:"error",variant:"flat",dark:"",onClick:o[9]||(o[9]=a=>it())},{default:r(()=>[m(" Cancel ")]),_:1}),e.formData2.estado=="RECIBIDO"&&(_(x)==1||_(x)==2)?(d(),y(D,{key:0,color:"success",variant:"flat",dark:"",onClick:o[10]||(o[10]=a=>z())},{default:r(()=>[m(" Guardar ")]),_:1})):(d(),y(D,{key:1,color:"primary",variant:"flat",dark:"",onClick:o[11]||(o[11]=a=>z())},{default:r(()=>[m(" Guardar ")]),_:1}))]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(St,{modelValue:F.value,"onUpdate:modelValue":o[13]||(o[13]=a=>F.value=a)},{default:r(()=>[s(G,{elevation:"10",class:"mt-3"},{default:r(()=>[s(H,{class:"text-h6"},{default:r(()=>[m("Solicitud de Repuestos")]),_:1}),s(q,{class:"mt-4"},{default:r(()=>[s(E,null,{default:r(()=>[e.formData.id_Rep.length>0?(d(),y(g,{key:0,cols:"12",md:"12"},{default:r(()=>[s(J,{density:"compact"},{default:r(()=>[t("thead",null,[t("tr",null,[oe,ae,se,re,ne,le,ie,de,P.value?(d(),f("th",ce,me)):I("",!0)])]),t("tbody",null,[(d(!0),f(k,null,j(e.formData.id_Rep,(a,i)=>(d(),f("tr",{key:i},[t("td",_e,c(i+1),1),t("td",pe,c(a.nombre_repuesto),1),t("td",fe,c(a.cantidad),1),t("td",be,c(a.unidad),1),t("td",he,c(a.costo),1),t("td",De,c(a.observacion),1),a.entregado==="PENDIENTE"?(d(),f("td",ve,[s(D,{class:"mr-1",size:"x-small",title:"Entregar repuesto",height:"25",width:"25",color:"success",text:"hola",onClick:p=>dt(a.id)},{default:r(()=>[s(_(L),{style:{cursor:"pointer"}})]),_:2},1032,["onClick"])])):(d(),f("td",xe,"ENTREGADO ")),a.recibido==="PENDIENTE"?(d(),f("td",ge,[s(D,{size:"small",title:"Recibir repuesto",height:"25",width:"25",color:"warning",text:"hola",onClick:p=>ct(a.id)},{default:r(()=>[s(_(L),{style:{cursor:"pointer"}})]),_:2},1032,["onClick"])])):(d(),f("td",ye,"ENTREGADO ")),a.entregado==="PENDIENTE"&&(_(x)==1||_(x)==2||_(x)==5)?(d(),f("td",Ve,[s(D,{class:"mr-1",size:"x-small",title:"Editar",height:"25",width:"25",color:"primary",text:"hola",onClick:p=>$(a.id)},{default:r(()=>[s(_(U),{style:{cursor:"pointer"}})]),_:2},1032,["onClick"])])):a.entregado==="RECIBIDO"&&(_(x)==1||_(x)==2)?(d(),f("td",Ce,[s(D,{class:"mr-1",size:"x-small",title:"Editar",height:"25",width:"25",color:"success",text:"hola",onClick:p=>$(a.id)},{default:r(()=>[s(_(U))]),_:2},1032,["onClick"])])):(d(),f("td",we,[s(D,{class:"mr-1",size:"x-small",title:"Editar",height:"25",width:"25",color:"",text:"hola"},{default:r(()=>[s(_(U))]),_:1})]))]))),128))])]),_:1})]),_:1})):I("",!0)]),_:1})]),_:1})]),_:1}),s(G,{elevation:"10",class:"mt-3"},{default:r(()=>[s(H,{class:"text-h6"},{default:r(()=>[m("Repuestos entregados")]),_:1}),s(q,{class:"mt-4"},{default:r(()=>[s(E,null,{default:r(()=>[e.formData.id_Rep2.length>0?(d(),y(g,{key:0,cols:"12",md:"12"},{default:r(()=>[s(J,{density:"compact"},{default:r(()=>[Ie,t("tbody",null,[(d(!0),f(k,null,j(e.formData.id_Rep2,(a,i)=>(d(),f("tr",{key:i},[t("td",ke,c(i+1),1),t("td",Ee,c(a.nombre_repuesto),1),t("td",Re,c(a.cantidad),1),t("td",Be,c(a.unidad),1),t("td",Se,c(a.costo),1),t("td",Ne,c(a.observacion),1)]))),128)),t("tr",null,[Te,Oe,Ue,Fe,Pe,t("td",Ae,c(e.formData.total_c)+" Bs.",1)])])]),_:1})]),_:1})):I("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(E,null,{default:r(()=>[s(g,{cols:"12",class:"text-lg-left pt-5"},{default:r(()=>[T.value?(d(),y(D,{key:1,color:"primary",disabled:""},{default:r(()=>[s(Nt,{indeterminate:"",color:"white",class:"mr-2"}),m(" Enviando... ")]),_:1})):(d(),f(k,{key:0},[s(D,{color:"error",class:"mr-3",onClick:o[14]||(o[14]=a=>rt())},{default:r(()=>[m("Volver")]),_:1}),e.formData.total=="0"?(d(),y(D,{key:0,color:"success",class:"mr-10",onClick:o[15]||(o[15]=a=>nt(_(C).params.id_orden))},{default:r(()=>[e.formData.id_registro!="0"&&P.value?(d(),f(k,{key:0},[m(" Imprimir ")],64)):I("",!0)]),_:1})):I("",!0)],64))]),_:1})]),_:1})],64)}}}),Ro=Tt($e,[["__scopeId","data-v-23c6c189"]]);export{Ro as default};
